<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.UserMapper">
<!--  관리자페이지에서 회원 조회  -->
    <select id="getAllUsers" resultType="UserDto">
        select * from user order by user_id
    </select>
    <insert id="insertUser" parameterType="UserDto">
        insert into user(password,user_name,email,hp) values (#{password},#{user_name},#{email},#{hp})
        <!-- INSERT 후에(after) 자동으로 들어간 guest_idx값을 얻어서 dto에 주입 -->
        <selectKey keyProperty="user_id" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>
    <select id="countEmail" parameterType="String" resultType="int">
        select count(*) from user where email = #{email}
    </select>
    <select id="getUserByUserName" parameterType="String" resultType="UserDto">
        select  * from user where user_name = #{user_name}
    </select>
    <select id="getUserByEmail" parameterType="String" resultType="UserDto">
        select  * from user where email = #{email}
    </select>
    <select id="getUserByUserId" parameterType="int" resultType="UserDto">
        select * from user where user_id = #{user_id}
    </select>
    <select id="selectAccessToken" parameterType="String" resultType="int">
        select rt_key from refresh_token where refresh_token = #{refresh_token}
    </select>
</mapper>